---
date: 2021/05/20
desc: æŠ›å¼ƒè¿‘ä¹è¿·æƒ‘çš„ sessionã€‚
---

# ä¸€ä¸ªç®€å•çš„åˆçº§ç™»å½•ç³»ç»Ÿ

å…ˆå‰ä¸€ç›´åœ¨æƒ³ç™»å½•ç³»ç»Ÿåˆ°åº•è¯¥æ€æ ·ç®€æ´åœ°å®ç°ã€‚åœ¨è¿™é‡Œï¼Œ*ç®€æ´*æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³æœ€åŸºæœ¬çš„ç”¨æˆ·è¯†åˆ«éœ€æ±‚ï¼Œè€Œæ²¡æœ‰å…¶å®ƒæ›´å¤šæ–¹é¢çš„éœ€æ±‚ï¼Œä¾‹å¦‚éªŒè¯æ–¹é¢ã€å®‰å…¨æ–¹é¢ç­‰ç­‰ã€‚å› è€Œæ¦‚æ‹¬æ¥è¯´ï¼Œæˆ‘ä»¬æ‰€è¦å®ç°çš„åªæ˜¯
ç™»å½•ä»¥åå‚¨å­˜çŠ¶æ€ï¼Œæ ¹æ®è¯¥çŠ¶æ€åˆ¤å®šè®¿é—®æƒé™ã€‚

:::tip
ğŸ˜ æœ¬æ–‡ä»£ç ä½¿ç”¨ PHP å®ç°ã€‚
:::

## åŸºæœ¬æ€è·¯

è¿™æ ·ä¸€ä¸ªç®€å•çš„ç™»å½•ç³»ç»Ÿçš„æ€è·¯ï¼Œå¤§è‡´å¦‚ä¸‹
1. **å‰ç«¯æ”¶é›†ç™»å½•ä¿¡æ¯ã€‚** åŒ…å«æœ€åŸºæœ¬çš„ä¸¤é¡¹ï¼šç”¨æˆ·åå’Œå¯†ç ã€‚
2. **åç«¯éªŒè¯ä¿¡æ¯å¹¶å‘æ”¾ *Token*ã€‚** åœ¨è¿™é‡Œï¼ŒéªŒè¯ä¿¡æ¯ä¸»è¦æ˜¯å¯¹æ•°æ®åº“ä¸­å¯¹åº”ç”¨æˆ·åçš„å¯†ç è¿›è¡Œæ¯”å¯¹ï¼Œå¯èƒ½çš„ç»“æœæœ‰*ä¸å­˜åœ¨*ã€*ä¸åŒ¹é…*å’Œ*åŒ¹é…*ä¸‰ç§ã€‚æœ¬æ–‡ä¸­æ¯”å¯¹æ‰€ä½¿ç”¨çš„æ–¹å¼æ˜¯ `password_verify` å‡½æ•°ã€‚
3. **å‰ç«¯å­˜å‚¨ *Token* å¹¶ç”¨äºæ‰§è¡Œå„é¡¹æ“ä½œã€‚** åç«¯æ‰€éœ€è¦æƒé™çš„æ“ä½œå¯ä»¥å°† Token ä½œä¸ºå‚æ•°ï¼Œéœ€è¦ Token æ‰èƒ½å·¥ä½œã€‚å‰ç«¯å­˜å‚¨ Token çš„åŠæ³•ï¼Œå¯ä»¥ç”¨ `localStorage`ã€‚å½“ç„¶ï¼Œä½¿ç”¨ Cookie ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚æœ¬æ–‡æ¼”ç¤ºå‰è€…ï¼Œå®ç°æ–¹å¼ç±»ä¼¼ã€‚
4. **é’ˆå¯¹ä¸åŒçŠ¶å†µæ‹Ÿå®š *Token* renew & expire ç­–ç•¥ã€‚** Token ä¸€å®šè¦æœ‰æœ‰æ•ˆæœŸï¼Œè‡ªç„¶è€Œç„¶ä¹Ÿæœ‰ renew å’Œ expire ç­‰é—®é¢˜ã€‚

ä¸Šé¢å››æ¡ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥æ³¨æ„è§£é‡Šå’Œå®è·µã€‚

## å®è·µ

### 1. Token è®¾è®¡

Token åˆ°åº•åº”è¯¥é•¿ä»€ä¹ˆæ ·ï¼Ÿå®é™…ä¸Šåº”è¯¥å…ˆè®¨è®ºæˆ‘ä»¬è¯¥æ€æ ·ä¼ é€’ Tokenã€‚ä¸ºäº†å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å¿…å®šè¦è®¾è®¡ä¸€äº›åŠ å¯†ï¼ˆencryptï¼‰æ–¹æ³•ã€‚ä¸ºäº†ä¿¡æ¯å¯å¤„ç†ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ€è€ƒæ€æ ·è¿›è¡Œè§£å¯†ï¼ˆdecryptï¼‰ã€‚åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å½“ç„¶ä¸èƒ½ç”¨ç®€ç®€å•å•çš„ base64 æ··åˆå…¶å®ƒèŠ±é‡Œèƒ¡å“¨æ–¹æ³•çš„è‚¤æµ…åŠ å¯†ï¼Œè€Œè¦ä½¿ç”¨ OpenSSL çš„ç›¸å…³æ–¹æ³•ã€‚

é¦–å…ˆï¼ŒOpenSSL çš„åŠ å¯†å‡½æ•°ä¸º `openssl_encrypt`ï¼Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥å°è£…å‡ºä¸€ä¸ªç®€å•çš„å®é™… encryptã€‚

```php
function encrypt($message, $key) {
    $nonceSize = openssl_cipher_iv_length('aes-256-ctr');
    $nonce = openssl_random_pseudo_bytes($nonceSize);

    $ciphertext = openssl_encrypt(
        $message,
       'aes-256-ctr',
        $key,
        OPENSSL_RAW_DATA,
        $nonce
    );
    
    return $nonce . $ciphertext;
}
```
å…¶ä¸­ï¼Œ**aes-256-ctr** ä¸ºåŠ å¯†æ–¹å¼ï¼Œå…·ä½“å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢äº†è§£ï¼Œè¿™æ˜¯æ¯”è¾ƒæ¨èä½¿ç”¨çš„ä¸€ç§æ–¹å¼ã€‚ä¸Šé¢çš„å‡½æ•°å…·ä½“å†…å®¹å°±ä¸å¤šè§£é‡Šã€‚åˆ©ç”¨ä¸Šé¢çš„å‡½æ•°ï¼Œåªéœ€è¦ä¸€ä¸ª key å³å¯å¯¹æŒ‡å®šä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œè¿™äº›ä¿¡æ¯ä¾¿æ˜¯æˆ‘ä»¬çš„ Tokenã€‚

é’ˆå¯¹ä¸Šé¢çš„ encrypt å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªå¯¹åº”çš„ decrypt å‡½æ•°ã€‚

```php
function decrypt($message, $key)
    {
        $nonceSize = openssl_cipher_iv_length('aes-256-ctr');
        $nonce = mb_substr($message, 0, $nonceSize, '8bit');
        $ciphertext = mb_substr($message, $nonceSize, null, '8bit');

        $plaintext = openssl_decrypt(
            $ciphertext,
            'aes-256-ctr',
            $key,
            OPENSSL_RAW_DATA,
            $nonce
        );

        return $plaintext;
    }
}
```
è€Œå®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½å¹¶ä¸å®Œå…¨å®‰å…¨ã€‚åœ¨åæ–‡ï¼Œæˆ‘ä»¬ä¼šä»‹ç»æ›´ä¸ºå®‰å…¨çš„ç‰ˆæœ¬ã€‚

è¿™ä¸¤å‡½æ•°ä¾¿è´Ÿè´£äº†åŠ å¯†å’Œè§£å¯†ã€‚æ¥ä¸‹æ¥ Token å†…å®¹çš„ç»„ç»‡ä¾¿å¾ˆå®¹æ˜“äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ï¼Œé‚£å°±æ˜¯ JSONã€‚ä¾‹å¦‚

```php
$token = json_encode([
    "expires" => strtotime("+1 week"),
    "creates" => time()
]);
```

å¯¹è¿™ä¸ª Tokenï¼Œæˆ‘ä»¬è¿›è¡Œ encryptï¼Œç„¶åè¿”å›åˆ°å‰ç«¯ï¼ŒåŸºæœ¬ä¸Šå°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ã€‚è¿™ä¸ª Token åœ¨å‰ç«¯å°†é•¿ä¹…å­˜åœ¨ï¼Œå› è€Œå…¶å¿…é¡»æŒ‡å®šä¸€ä¸ªåˆç†çš„ expires ä»¥ä¾¿åç«¯åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚åŒæ—¶ä¸ºäº†é¿å…å†’å……ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ Token å†…åŠ å…¥ä¸€äº›ç‰¹å¼‚æ€§å†…å®¹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ç­¾åã€‚

### Token å­˜å‚¨

æŒ‰ç…§è®¾è®¡ï¼ŒToken è¢«è¿”å›åˆ°å‰ç«¯ä»¥åä¼šè¢«å­˜å‚¨èµ·æ¥ï¼Œç›®çš„æ˜¯ä½œä¸ºæ•æ„Ÿæ“ä½œï¼ˆæ¶‰åŠæƒé™çš„æ“ä½œï¼‰çš„å‡­è¯ã€‚ä¾‹å¦‚è‹¥è¦ POST æ¶‰åŠæƒé™çš„æ“ä½œï¼Œåˆ™å¿…é¡»å¸¦ä¸Š Tokenï¼Œå¦åˆ™è¿”å› 400ã€‚

ä¸Šæ–‡å·²ç»æåˆ°ï¼Œæˆ‘ä»¬å°†ä¼šä½¿ç”¨ localStorage æˆ–è€… Cookieã€‚ä¾‹å¦‚

```javascript
// å‡è®¾ r ä¸ºåç«¯è¿”å›çš„ Tokenï¼ˆå·²åŠ å¯†å­—ç¬¦ä¸²ï¼‰
localStorage.setItem('xxx-login-token', r);
```

è‡³æ­¤å®ƒå°±è¢«å­˜äº†èµ·æ¥ã€‚è‡³äº localStorage ä¿å­˜æ•°æ®çš„æŒç»­æ€§ï¼Œå¯ä»¥å‚è€ƒ StackOverflow [How Persistent is localStorage?](https://stackoverflow.com/questions/9948284/how-persistent-is-localstorage)ã€‚

å¯¹äº Chromeï¼ŒlocalStorage æŒç»­æ€§çš„å™è¿°ä¸º

> On disk until deleted by user (delete cache) or by the app. 

<small>æ¥è‡ª <a href='http://www.gwtproject.org/doc/latest/DevGuideHtml5Storage.html' target='_blank'>GWTProject</a></small>

æ‰€ä»¥å®é™…ä¸Šä¸éœ€è¦æ‹…å¿ƒ localStorage è¢«æ— ç¼˜æ— æ•…æ¸…æ‰ã€‚æ¢å¥è¯è¯´ï¼ŒToken å°†ä¼šåœ¨ localStorage ä¸­é•¿æœŸå­˜åœ¨ã€‚

åœ¨è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šlocalStorage åœ¨å®šä¹‰ä¸Šæ˜¯å±äºç”¨æˆ·çš„ä¸œè¥¿ï¼Œç”¨æˆ·å¯ä»¥å®Œå…¨ç®¡ç†å…¶å†…å®¹ï¼Œå¯ä»¥æ·»åŠ ã€è¯»å–å’Œä¿®æ”¹å…¶å†…å®¹ï¼Œè¿™ä¼šå¯¹ Token çš„å®‰å…¨æ€§é€ æˆä»€ä¹ˆå½±å“ï¼Ÿ

å®é™…ä¸ŠåŸºæœ¬æ²¡æœ‰ã€‚å› ä¸º Token åªèƒ½ç”±åç«¯ç”Ÿæˆï¼Œè€Œç”¨æˆ·æŠŠ Token ä¿®æ”¹äº†ç›¸å½“äºè‡ªå·±æ”¾å¼ƒäº†è¿™ä¸ª Tokenï¼Œè¢«ä¿®æ”¹åçš„ Token ä¹Ÿæ— æ³•é€šè¿‡éªŒè¯ï¼ˆdecryptï¼‰ã€‚å”¯ä¸€éœ€è¦é˜²å¤‡çš„ï¼Œå°±æ˜¯ä¸è¦æ³„æ¼ Token çš„åŠ å¯†æ–¹å¼ã€‚å¦‚æœåŠ å¯†æ–¹å¼æ³„æ¼ï¼Œé‚£ä¹ˆç”¨æˆ·å°±å¯ä»¥åˆ©ç”¨å„ç§æ–¹æ³•é‡‡å–å®Œå…¨ç›¸åŒçš„åŠ å¯†æ–¹å¼åŠ å¯†å‡ºå®Œå…¨ç¬¦åˆæœåŠ¡ç«¯è§£å¯†å‡½æ•°éœ€æ±‚çš„ Tokenã€‚åœ¨è¿™é‡Œï¼ŒåŠ å¯†æ–¹å¼åŒ…å«çš„ä¸ä»…ä»…æ˜¯ method æœ¬èº«ï¼Œè¿˜æœ‰ keyã€‚

### Token åˆ©ç”¨

Token çš„åˆ©ç”¨ä¸»è¦ä½“ç°åœ¨è¯·æ±‚ä¸Šï¼Œä¸”æœ‰å¤šç§ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºæœ€ä¸ºç®€å•çš„ä¸€ç§ï¼šæ¯ä¸€æ¬¡ POST æ•æ„Ÿæ“ä½œæ¥å£ï¼Œé™„å¸¦ä¸Š Token ä½œä¸ºå‚æ•°ï¼Œåç«¯åœ¨æ¥åˆ°è¯·æ±‚åï¼Œç¬¬ä¸€æ­¥æ˜¯éªŒè¯ Tokenï¼Œé€šè¿‡åç»§ç»­æ“ä½œã€‚

æ¯”å¦‚ï¼Œæ¯æ¬¡ route è·³è½¬åˆ°æ•æ„Ÿé¡µé¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œè¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š

```typescript
function checkAuth() {
  let token = localStorage.getItem("xxx-login-token");
  return new Promise((r, j) => {
    if (!token) {
      j();
    } else {
      post(
        "/CheckAuth.php",
        {
          token,
        },
        (response) => {
          if (response === true) {
	      r();
          } else {
            j();
          }
        }
      );
    }
  });
}
```

è¿™ä¸ªå‡½æ•°ä¼šè·å– localStorage ä¸­çš„ Token å¹¶å‘é€ç»™åç«¯ç›¸åº”çš„æ¥å£ï¼Œé€šè¿‡éªŒè¯ï¼Œè¿”å›ä¸€ä¸ªç»“æœå€¼ï¼Œå‰ç«¯å†æ ¹æ®è¿™ä¸ªç»“æœå€¼å†³å®šæ˜¯å¦è·³è½¬åˆ°æŒ‡å®šçš„é¡µé¢ã€‚

è‡³äº Token æ€æ ·éªŒè¯ï¼š

```php
function checkToken(string $token)
{
    $key = '...'; // æä¾›åŠ å¯†æ—¶çš„ key ä»¥è§£å¯†
    try {
        $content = json_decode(decrypt($token, $key, true), true);
        if ($content["expires"] > time()) {
            return true;
        } else {
            return false;
        }
    } catch (Exception $e) {
        return false;
    }
}
```

å…·ä½“åº”ç”¨ä¸­è¿˜å¯ä»¥æ·»åŠ æ›´å¤šéªŒè¯æ–¹å¼åœ¨é‡Œé¢ã€‚éªŒè¯æˆåŠŸï¼Œå°±ä¼šè¿”å›ä¸€ä¸ª trueã€‚å¦‚æœè¿‡æœŸï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å› falseã€‚å¦‚æœæ˜¯æ— æ•ˆçš„ Tokenï¼Œæ ¹æ®ä¸Šé¢çš„ encrypt å’Œ decrypt å‡½æ•°ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª Exceptionã€‚å¦‚æœäº§ç”Ÿè¿™ä¸ª Exceptionï¼Œå°±ä»£è¡¨é€šè¿‡éªŒè¯çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¿…è¦æ¡ä»¶ä¸æ»¡è¶³ï¼Œè‡ªç„¶å°±èƒ½åˆ¤å®šè¿™ä¸ª Token æ— æ•ˆã€‚

### Token renew & expire ç­–ç•¥

å¦‚æœ Token è¿‡æœŸäº†ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒå½“ä½œæ— æ•ˆ Token åŒç­‰å¤„ç†ï¼Œå³ `checkToken(x)` å‡½æ•°æ°¸è¿œè¿”å› falseã€‚

è‡³äº Token çš„æ›´æ–°ä»¥åŠé”€æ¯ï¼Œå‰è€…ä¼šå‘ç”Ÿåœ¨ç™»å½•æ—¶ã€‚ç”±äº Token å·²ç»è¢«ï¼ˆè¿‘ä¹ï¼‰æ°¸è¿œå­˜åœ¨äº†å‰ç«¯ï¼Œæ‰€ä»¥è¿‡æœŸçš„ Token å¹¶æ²¡æœ‰å¿…è¦ç›´æ¥åˆ é™¤ã€‚æ¯æ¬¡ç™»å½•çš„æ—¶å€™ï¼Œå¦‚æœ Token æ²¡æœ‰è¿‡æœŸï¼Œé‚£ä¹ˆç›´æ¥è·³è½¬åˆ°ç›¸å…³é¡µé¢ï¼Œå¦‚æœ Token è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå°±è¿”å›ä¸€ä¸ªæ–°çš„ Tokenã€‚æ‰§è¡Œ localStorage çš„ setItem è¯­å¥ç›´æ¥è¦†ç›–æ—§ Token å³å¯ã€‚è€Œå¯¹äºé”€æ¯ï¼Œåˆ™æ˜¯ç”¨æˆ·ä¸“é—¨åœ¨ Token æœ‰æ•ˆçš„æ—¶å€™æ‰§è¡Œäº†ç›¸å…³çš„æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸éœ€è¦å’Œåç«¯æ²Ÿé€šï¼Œè€Œå‰ç«¯ç›´æ¥åˆ å» localStorage ä¸­ Token å¯¹åº”çš„æ•°æ®å³å¯ï¼Œç”±äºå‰é¢è·¯ç”±é€»è¾‘çš„å­˜åœ¨ï¼Œé¡µé¢åˆ·æ–°ä»¥åä¸€åˆ‡å°±è·Ÿæ²¡æœ‰ç™»å½•ä¸€æ ·äº†ã€‚

### æ›´å®‰å…¨çš„ encrypt å’Œ decrypt

æ›´å®‰å…¨çš„ encrypt æ˜¯å°†åŸå…ˆä¸å®‰å…¨å‡½æ•°çš„åŠ å¯†ç»“æœçš„å¼€å¤´åŠ ä¸Šä¸€ä¸ªè®¡ç®—å‡ºçš„ MAC å€¼ã€‚

```php
function encrypt($message, $key)
    {
        list($encKey, $authKey) = splitKeys($key);
        $ciphertext = unsafe_encrypt($message, $encKey);

        // è®¡ç®—
        $mac = hash_hmac('sha256', $ciphertext, $authKey, true);
        
        // æŠŠ MAC æ”¾åœ¨å¼€å¤´
        return $mac . $ciphertext;
    }
```

æ›´å®‰å…¨çš„è§£å¯†ä¹Ÿæ˜¯åŸºäº MAC çš„ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆéªŒè¯ MACï¼Œç„¶åå†ä½¿ç”¨å…ˆå‰çš„è§£å¯†å‡½æ•°å³å¯ã€‚

```php
    public static function decrypt($message, $key)
    {
        list($encKey, $authKey) = splitKeys($key);

        // é¿å…åŠ å¯†ç®—æ³•å˜æ¢
        $hs = mb_strlen(hash('sha256', '', true), '8bit');
        $mac = mb_substr($message, 0, $hs, '8bit');

        $ciphertext = mb_substr($message, $hs, null, '8bit');

        $calculated = hash_hmac(
            'sha256',
            $ciphertext,
            $authKey,
            true
        );

        if (!hashEquals($mac, $calculated)) {
            throw new Exception();
        }

        $plaintext = unsafe_decrypt($ciphertext, $encKey);

        return $plaintext;
    }
```

ä»¥ä¸Šæ“ä½œä¾èµ–äº†ä¸¤ä¸ªé¢å¤–çš„å‡½æ•°ã€‚ä¸€ä¸ªæ˜¯ç”¨æ¥æŠŠä¸€ä¸ª key åˆ†å‰²æˆä¸€ä¸ªç”¨æ¥åŠ å¯†ä¸€ä¸ªç”¨æ¥éªŒè¯çš„ä¸¤ä¸ª keyã€‚

```php
function splitKeys($masterKey)
    {
        return [
            hash_hmac('sha256', 'ENCRYPTION', $masterKey, true),
            hash_hmac('sha256', 'AUTHENTICATION', $masterKey, true)
        ];
    }
```

å¦ä¸€ä¸ªæ˜¯ç”¨æ¥éªŒè¯ hash æ˜¯å¦å…¨ç­‰ã€‚

```php
function hashEquals($a, $b)
    {
        if (function_exists('hash_equals')) {
            return hash_equals($a, $b);
        }
        $nonce = openssl_random_pseudo_bytes(32);
        return hash_hmac('sha256', $a, $nonce) === hash_hmac('sha256', $b, $nonce);
    }
}
```

## æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹æ¥è¯´ç‰¹åˆ«ç®€å•çš„ç™»å½•æˆ–è€…è¯´æ˜¯éªŒè¯ç³»ç»Ÿã€‚ä¸»è¦çš„ä»£ç éƒ½å†™åœ¨äº†åŠ å¯†å’Œè§£å¯†ä¸Šã€‚å¯¹äºè¿™æ ·ä¸€ä¸ªç³»ç»Ÿï¼Œæ˜¯è‚¯å®šå­˜åœ¨æ¼æ´çš„ï¼Œå› è€Œä¸èƒ½ç”¨æ¥å½“ä½œä¸€ä¸ªç‰¹åˆ«é‡è¦ç³»ç»Ÿçš„ä¸»è¦éªŒè¯æ–¹å¼ã€‚ä½†æ˜¯é€šè¿‡å®Œå–„ï¼Œè¿˜æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ªç³»ç»Ÿçš„æœ‰æ•ˆæ€§çš„ã€‚

è¿™ä¸ªç³»ç»Ÿåœ¨æµè§ˆå™¨æ— ç—•æ¨¡å¼ä¸‹æ˜¯æ— æ³•è®°å½• Token çš„ï¼Œè¿™ç‚¹å’Œæ­£å¸¸çš„ç™»å½•ä¹Ÿç±»ä¼¼ã€‚

è¿™ä¸ªç³»ç»Ÿä¸æ­¢ PHP èƒ½å®ç°ï¼Œè€Œèƒ½åœ¨æ‰€æœ‰çš„è¯­è¨€ä¸­å®ç°ã€‚
