"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[228],{3228:function(e,o,n){n.r(o),n.d(o,{default:function(){return r}});var a=n(3396);const d={class:"content"},s=(0,a.uE)('<h1 class="post-title">记一次手贱导致的电脑危机<a class="header-anchor" id="%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%89%8B%E8%B4%B1%E5%AF%BC%E8%87%B4%E7%9A%84%E7%94%B5%E8%84%91%E5%8D%B1%E6%9C%BA" href="#%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%89%8B%E8%B4%B1%E5%AF%BC%E8%87%B4%E7%9A%84%E7%94%B5%E8%84%91%E5%8D%B1%E6%9C%BA">#</a></h1><div class="metabar"><div class="metabar-item">2021/01/02</div><div class="metabar-item">记录</div><div class="metabar-item">约 7 分钟读完</div></div><p>对于那些不通过一些手段无法修复的问题，我一般统称为<strong>‌电脑危机</strong>。最近的几年里经历的电脑危机有点多，甚至还让我损失了一些昂贵的配件，而且它们产生的原因都是匪夷所思的，让我怀疑自己是不是真的运气不好。那么这一次就把它记录下来吧。</p><h2>起因<a class="header-anchor" id="%E8%B5%B7%E5%9B%A0" href="#%E8%B5%B7%E5%9B%A0">#</a></h2><p>起因很简单也很搞笑，我自己手贱把 Windows 设置里的 HDR 打开了。可能是因为 HDMI 线缆或者显卡等问题，电脑显示屏再起不能，然而依然有声音，代表只是显示不了。在这里我要疯狂抱怨一下 Windows 对这个的处理，分辨率调错了还可以自动回退（倒计时），HDR 这种东西就直接默认了！无语子。</p><p>接下来就该想办法解决了，那么我究竟用了些什么办法呢？</p><h2>解决之路<a class="header-anchor" id="%E8%A7%A3%E5%86%B3%E4%B9%8B%E8%B7%AF" href="#%E8%A7%A3%E5%86%B3%E4%B9%8B%E8%B7%AF">#</a></h2><h3>想办法把 HDR 关掉</h3><p>首先我在想办法进入安全模式。根据我模糊的记忆，安全模式应该不会有这些七七八八的设置的。然而我又想起来 Windows 10 也并没有古老的 F8 概念，于是开始 Google。结果发现，可以通过开机过程中多次长按电源键强制关机，让电脑意识到你有麻烦，自动进入修复界面，我试了一下是真的，心疼硬盘。</p><p>那么我进入了安全模式，发现...HDR 居然是关的。然而我又进了一遍系统，还是黑屏，那么这就代表着 HDR 这玩意...对系统是独立的！而且也有可能因为安全模式并没有完全加载显卡驱动导致设置内容产生差异。这可怎么办？想到了用指令来关闭，然而看到了微软官方的回答，没有指令。这路可封得死死的了。</p><h3>想办法通过重装系统还原 HDR 有关设置</h3><p>于是这个时候只能想到一点，那就是重装系统。修复界面里的确是有重装系统的选项的，于是我毫不犹豫地点击了保留用户个人资料恢复。结果直接给我来了个恢复失败，自动回退，也是有够倒霉（或者说，一般在这种模式下恢复成功的概率很小？）。重启后直接默认进恢复页面，我想再次恢复，结果过一会直接给你又返回到选择页面去了。</p><p>噢，天呐，活生生的系统就这么被折腾死了。我忽然又想起来之前安过一个 Ubuntu，结果发现是个坏的。还好，我的手边还有一个有着 Ubuntu 20 的 U 盘，如果没有它，就没有后面的故事了。</p><h3>想办法用 Ubuntu 尝试版制作 Windows 安装 U 盘</h3><p>安装 Ubuntu 的时候，有一个不安装直接尝试的选项（Try without installation），因为我也只是临时使用，所以就试了一下这个模式。用起来也挺顺的，就是表现有些奇怪。因为我蛮久之前下了一些 Windows 的 ISO 到数据盘里（不过 Windows 10 的只有 1809），所以想着能不能把这个 ISO 复制到当前装有 Ubuntu 的 U 盘里，再重启。</p><p>结果，复制是复制成功了，就是选择 U 盘启动后仍然回到了 Ubuntu，就像我啥都没动一样。又打开了尝试，看了看这个 U 盘的内容，发现之前我复制的东西都消失了，全都恢复成了原样...这是甚么原理？</p><p>那这么看来，用 Ubuntu 的尝试模式貌似会出现这种奇怪问题，虽然说不出原理，但是关系好像也蛮大的吧？于是我只好安了一份 Ubuntu 到 HDD 上。</p><h3>想办法用 Ubuntu 制作 Windows 安装 U 盘</h3><p>这下好了，Ubuntu 正常安装上了。然而这个时候又出现了一个问题，U 盘变成了 readonly。我很纳闷，但无处表达自己的想法。我本来想把 U 盘先格式化一遍的，结果发现是 readonly。接下来，我又尝试了很多种办法，包括但不仅限于</p><h4>1. 检查 <code>ntfs-3g</code> 等驱动程序是否正常安装</h4><p>因为我的 U 盘先前的格式是 NTFS，对于 Ubuntu 来说有一定的门槛，需要依赖这些玩意。结果经过检查发现这些东西 Ubuntu 都自带有。</p><h4>2. 重新 <code>mount</code></h4><p>这一步分为几个版本，包括一些我在 StackOverflow 上面找到的。一个是先 <code>umount</code> 再 <code>mount</code>，提示 <code>cannot mount /dev/sdc1 read-write</code>，然后它就自动变成 readonly 了。一个是先 <code>umount</code>，然后通过 <code>hdparm -r0 /dev/sdc1</code> 把 <code>/dev/sdc1</code> 强行设置成 <code>readonly = 0</code> 也就是关掉 readonly 的状态，虽然输出的信息是对的，但是 <code>mount</code> 以后依然提示不行。还有一个，是通过 <code>mount -o remount,rw /media/subilan/data</code> 把挂载点重新挂载成 readwrite，结果很奇怪，那就是所有跟这个挂载点有关的操作都会卡死（比如 <code>cd /media/subilan/data</code>，或者是通过文件管理器进入这个目录，亦或者是用 GParted 打开 <code>/dev/sdc</code>）。</p><p>显然行不通。</p><p>最后我反思了一下，也有可能是安装系统安装失败被系统给锁了，这个好像是无解的...所以，U 盘相当于是废了，那我装 Ubuntu 的意义是？</p><h3>想办法用 Ubuntu 制作 Windows 安装介质</h3><p>现在的问题就是，我有系统的 ISO，但是不知道如何从这个 ISO 启动。不过，借助于万能的 Google，我似乎找到了我想要的东西，那就是 <a href="https://github.com/WoeUSB/WoeUSB" class="external-link" target="_blank" rel="noopener noreferrer">WoeUSB<span class="external-link-icon mdi mdi-launch"></span></a>（刚开始搜的时候叫 WinUSB，后来发现改名了）。但是根据它的介绍，好像依然是需要 U 盘的哈？然而我是 Google <code>install windows on ubuntu without usb</code>，所以就试了一试。</p><p>根据它给的介绍，有 <code>device</code> 和 <code>partition</code> 两种模式，我当然是选择后者，虽然不知道它们指的是不是同一样东西。于是我就</p><div class="language-bash"><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> ./woeusb.bash <span class="token parameter variable">--partition</span> Windows10_1804.iso /dev/sdb4\n<span class="token comment"># /dev/sdb4 是我分出来的一个用来装 iso 内容的区</span>\n</code></pre></div><p>然后它就开始进行一系列操作，最后告诉我成功了。挂上 <code>/dev/sdb4</code>，发现里面就是 ISO 的内容。真的能直接从它启动？重启了一下，BIOS 里出现了一个 UEFI OS 的选项，我惊了。打开后，果然是安装程序，于是就在电脑上成功安上了 Windows 10——1804，最后再用易升升级到了 20H2。</p><p><img src="https://i.loli.net/2021/01/02/4IhTsgH5fm8ivjU.png" alt=""></p><h2>事后<a class="header-anchor" id="%E4%BA%8B%E5%90%8E" href="#%E4%BA%8B%E5%90%8E">#</a></h2><p>这一切都有那么一点点像是滑坡谬误：无脑打开 HDR——电脑无法显示——无法关闭 HDR——重装系统失败——Ubuntu 里的一系列挫折——WoeUSB 解救——数据全然丢失（不过当时复制了一些重要数据，所以问题不大）。然而它能告诉我的是以后千万不要手贱动这种悬乎的玩意儿了！当然归根结底还是自己菜罢了。</p><p><img src="https://i.loli.net/2021/01/02/2gxtK8M96juyQzJ.png" alt="QQ截图20210102121937.png"></p><p>现在看到它就感觉是死神在向我招手👋💀</p>',35),t=[s];function c(e,o){return(0,a.wg)(),(0,a.iD)("div",d,t)}var i=n(89);const p={},u=(0,i.Z)(p,[["render",c]]);var r=u}}]);
//# sourceMappingURL=228.2548b0ac.js.map