{"version":3,"file":"js/644.cffc6d76.js","mappings":"0KAAKA,MAAM,W,GAAXC,EAAAA,EAAAA,IAAA,umM,GAAqBC,G,kCAArBC,EAAAA,EAAAA,IAmEM,MAnENC,EAAAC,E,aCCA,MAAMC,EAAS,CAAC,EAGVC,GAA2B,OAAgBD,EAAQ,CAAC,CAAC,SAASE,KAEpE,O","sources":["webpack://blog/./src/posts/Some-Gossip-on-Vercel.vue","webpack://blog/./src/posts/Some-Gossip-on-Vercel.vue?1600"],"sourcesContent":["<template><div class=\"content\"><h1 class=\"post-title\">åæ§½ä¸€ä¸‹ Vercel çš„å¤§æ— è¯­æ“ä½œ<a class=\"header-anchor\" id=\"%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%20Vercel%20%E7%9A%84%E5%A4%A7%E6%97%A0%E8%AF%AD%E6%93%8D%E4%BD%9C\" href=\"#%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%20Vercel%20%E7%9A%84%E5%A4%A7%E6%97%A0%E8%AF%AD%E6%93%8D%E4%BD%9C\">#</a></h1><div class=\"metabar\"><div class=\"metabar-item\">2023/12/13</div><div class=\"metabar-item\">ä»£ç </div><div class=\"metabar-item\">çº¦ 9 åˆ†é’Ÿè¯»å®Œ</div></div>\n<div class=\"notice tip\"><p>è¯´æ˜¯åæ§½ï¼Œå‘ç°ä¸çŸ¥ä¸è§‰å†™æˆäº†æµæ°´è´¦ã€‚çœ‹ä¸ªä¹å‘µå°±å¥½ ^_^'...</p>\n</div>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifIWGV.png\" alt=\"\">\n<em>æ‹±å‡ºå»ï¼Œæ‹±å¾—è¿œè¿œçš„</em></p>\n<p>å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸ªç½‘ç«™è‡ª 2023 å¹´ 7 æœˆè¢«æ¬è¿åˆ°äº† Vercel ä¸Šé¢ï¼Œé‡‡ç”¨ GitHub æ‰˜ç®¡æºä»£ç +Vercel æŒç»­é›†æˆè‡ªåŠ¨éƒ¨ç½²çš„æ¨¡å¼æ¥å‘ˆç°ã€‚è€ƒè™‘åˆ°ä½¿ç”¨ Vercel çš„ä¸€å¤§åŸå› ï¼Œæ˜¯ å¯¹ Vue çš„è·¯ç”±ç›¸å…³è€ƒè™‘ï¼ˆ<strong>Wanna have ugly #Hashtag in URL or 404 on refresh???</strong>ï¼‰ï¼Œè¿™æ˜¯åœ¨æ­å»ºè¿™æ ·çš„ä½æˆæœ¬é™æ€ç½‘ç«™æ—¶ç»å¸¸ä¼šé‡åˆ°çš„ä¸€ç±»ç„¦ç¼ã€‚</p>\n<p>ç„¶åå°±åœ¨å‡ å¤©å‰ï¼Œä¸€ä½ä¼™ä¼´å‘æˆ‘å‘æ¥é‚®ä»¶è¯·æ±‚æ·»åŠ å‹é“¾ã€‚ç­‰æˆ‘ä¿®æ”¹å¥½ <code>Blogroll.vue</code> ä»¥åï¼Œå´å‘ç° deploy ä¸ä¸Šäº†ï¼Œç°è±¡æ˜¯ <code>vue-cli-service build</code> äº† 45 åˆ†é’Ÿè¿˜æ²¡æœ‰éƒ¨ç½²å¥½ï¼Œè¶…æ—¶è¢« killã€‚æˆ‘çœŸæƒŠäº†ï¼Œå› ä¸ºå¹³æ—¶ deploy åŸºæœ¬ä¸Šç”¨ä¸åˆ° 2 åˆ†é’Ÿï¼ˆå¦‚æœå¼¥è¡¥äº†ä½¿ç”¨ puppeteer çš„å¤§å‘ï¼Œé‚£ä¹ˆç”šè‡³ä¸åˆ° 1 åˆ†é’Ÿï¼‰ï¼Œä¸æ¸…æ¥šæ˜¯å•¥æƒ…å†µã€‚è€Œä¸”æˆ‘å°è¯•æœ¬åœ° buildï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p>\n<p>äºæ˜¯æˆ‘å°±å‘ç°äº† Node å¼•èµ·çš„è¿™ä¸ªç¦»è°±çš„ Bugï¼Œä»¥åŠ Vercel æ— è„‘å¸®åŠ©ç”¨æˆ·åšç‰ˆæœ¬å†³å®šçš„è’è°¬æœºåˆ¶ã€‚</p>\n<p>é¦–å…ˆï¼Œæˆ‘å°è¯• redeployï¼Œå‘ç°æ¯æ¬¡çš„è¡¨ç°ä¸ä¸€è‡´ã€‚ä¸Šé¢çš„é‚£ä¸€ç§è¡¨ç°æ˜¯å¡æ­»æ— ååº”ï¼Œä¸€ç›´æŒç»­åˆ°è¶…æ—¶ï¼Œè€Œå¦å¤–è¿˜æœ‰ä¸¤ç§è¡¨ç°ï¼š</p>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifIoqJ.png\" alt=\"\">\n<em>ä½ æ²¡äº‹å§ï¼Ÿ</em></p>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifI7Z9.png\" alt=\"\">\n<em>ä½ æ²¡äº‹å§ï¼Ÿï¼Ÿ</em></p>\n<p>ä¸€ç§æ˜¯éšæœºä½ç½®å‡ºç° <code>Unexpected token [???random, mostly a blank] in JSON at position [???random]</code> çš„æŠ¥é”™ï¼Œ<code>???random</code> ä¸­ä¸‰ä¸ªé—®å·è¡¨ç¤ºæˆ‘çš„æåº¦ç–‘æƒ‘å’Œä¸¥å‰æ‰¹è¯„ã€‚å¦ä¸€ç§æ˜¯å…ˆç»™ä¸€ä¸ªè«åå…¶å¦™çš„ <code>undefined:1</code>ï¼Œç„¶åè¾“å‡ºä¸€å¤§æ®µè«åå…¶å¦™çš„ JSONã€‚</p>\n<p>æˆ‘æ€€ç€ä¾¥å¹¸å¿ƒç†ï¼Œé€‰æ‹©äº†è¿™ä¸€å¤§æ®µè«åå…¶å¦™çš„ JSON åœ¨ Google ä¸Šæœç´¢ã€‚ä¹Ÿä¸çŸ¥é“æ˜¯è¿æ°”å¥½è¿˜æ˜¯å’‹åœ°ï¼Œè¿˜çœŸæœåˆ°äº†æœ‰äººåœ¨ Issue ä¸Šçš„åé¦ˆï¼ˆåæ¥æˆ‘å‘ç°å†éšä¾¿é€‰ç„¶åæœï¼Œä¹Ÿæœä¸åˆ°äº†ğŸ˜“ï¼‰ã€‚</p>\n<ul>\n<li>https://github.com/orgs/community/discussions/69293</li>\n</ul>\n<p>è¿™ä¸ª Discussion åé¦ˆçš„é—®é¢˜å’Œæˆ‘çš„åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼ˆä¹Ÿæ˜¯ä½¿ç”¨ <code>vue-cli-service</code> æ¥æ„å»ºçš„æ—¶å€™å‡ºç°çš„ï¼Œè™½ç„¶è¿™ä¸ªæ•…äº‹å’Œ Vue å…³ç³»åº”è¯¥ä¸å¤ªå¤§ï¼Ÿï¼‰ï¼Œä»–æ˜¯è¿™ä¹ˆæè¿°çš„ï¼š</p>\n<blockquote>\n<p>Hello. Long story short <strong>2 weeks ago everything worked fine</strong> with Github actions. Now we only commited a small style change (a new CSS rule for an ID) and the build for CI/CD failed. We are deploying to an Azure environment. npm install works just fine, no other modification were done and last build was successful.</p>\n<p>............</p>\n<p>We tried everything from updating all packages to using the known working versions, checking the code etc. <strong>On our local machines it's working well.</strong> Any idea of how to solve this would be welcomed.</p>\n</blockquote>\n<p>ç„¶åè¿™ä¸ªå¸–å­æŒ‡å‘äº†è¿™ä¸ª Issue</p>\n<ul>\n<li>https://github.com/webpack-contrib/thread-loader/issues/191</li>\n</ul>\n<p>å…¶ä¸­è¯´åˆ°çš„ Actual Behaviour å’Œæˆ‘é‡åˆ°çš„ä¸€æ¨¡ä¸€æ ·ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šäº†ï¼š</p>\n<blockquote>\n<p><strong>Actual Behavior</strong></p>\n<p>Webpack build either <strong>hangs indifinetely</strong> or fails with the following 2 errors:</p>\n<ul>\n<li>JSON <strong>Parse failed unexpected token at random, each time, positions</strong></li>\n<li>Error EPIPE</li>\n</ul>\n</blockquote>\n<p>ä¸‹é¢çš„è¯„è®ºä¸­æåˆ°æ˜¯ Node 18.18 ä¸­çš„ <code>libuv</code> åº“å‡çº§å¯¼è‡´çš„ï¼Œå¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ªç¯å¢ƒå˜é‡æ¥é¿å…å‡ºç°é—®é¢˜ã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆè¿˜æœ‰äº›è®¸äººç‚¹èµã€‚åæ¥è¯•äº†ä¸€ä¸‹å‘ç°å¯¹æˆ‘æ¥è¯´å¹¶ä¸å¯ä»¥ã€‚</p>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifoliq.png\" alt=\"\"></p>\n<p>æœ‰ä¸€ä¸ªäººå›æ»šåˆ° 18.17 å°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚äºæ˜¯æˆ‘ç»ˆäºçŸ¥é“ä¸ºä»€ä¹ˆæˆ‘å¯ä»¥åœ¨æœ¬åœ° build è€Œåˆ° Vercel ä¸Šå°±ä¼šçˆ†ç‚¸äº†ã€‚å› ä¸ºæˆ‘æœ¬åœ°ç‰ˆæœ¬å°±æ˜¯ 18.17ï¼Œè€Œ Vercel ä¸Šå°±æ˜¯ 18.18......äºæ˜¯æˆ‘å¼€å§‹æƒ³åŠæ³•ï¼Œå¦‚ä½•ä¿®æ”¹ Vercel çš„ Node ç‰ˆæœ¬ã€‚åœ¨ç¿»çœ‹é…ç½®é¡¹çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªè°ƒæ•´ç‰ˆæœ¬çš„åœ°æ–¹ï¼Œå´åªæœ‰å¯æ€œçš„ä¸‰ä¸ªé€‰é¡¹ï¼š<code>16.x</code>ã€<code>18.x</code> å’Œ <code>20.x</code>ï¼Œå…¶ä¸­ <code>16.x</code> é€‰ä¸­äº†ä¼šæç¤ºä½  deprecatedï¼Œ<code>20.x</code> é€‰ä¸­äº†ä¼šæç¤ºä½  beta...å·²ç»å¼€å§‹æœ‰ç‚¹åˆ«æ‰­äº†ã€‚è€Œè¿™ä¸ª <code>18.x</code>ï¼Œæ²¡æœ‰æ˜ç¡®çš„ç‰ˆæœ¬å·ï¼Œè€Œå®é™…ä¸Š <code>node -v</code> è¾“å‡ºçš„å°±æ˜¯ 18.18 æœ€æ–°ç‰ˆã€‚</p>\n<p>äºæ˜¯è‡ªç„¶æˆ‘æŠŠç›®æ ‡è½¬å‘å¦‚ä½•æ”¹ä¸º 18.17ã€‚å®˜æ–¹æä¾›äº†æ–‡æ¡£ï¼Œæ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p>\n<blockquote>\n<p>You can define the specific node version in the engines section of the package.json to override the Project Settings. However, the value set in the Project Settings dictates the accepted values for the node property.\nFor instance, when you set 20.x in the Project Settings you can specify a valid v20 range in package.json. But setting &gt;16.0.0 with 16.x selected, will deploy with the latest v18.</p>\n</blockquote>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ Vercel ä¸Šä½ ä¸èƒ½ä½¿ç”¨å¥‡æ•°ç‰ˆæœ¬çš„ Nodeï¼Œå› ä¸ºé€‰é¡¹ä¸­æ ¹æœ¬æ²¡æœ‰ï¼Œè€Œåªèƒ½æ‰‹åŠ¨æŒ‡å®šå¤§ç‰ˆæœ¬èŒƒå›´å†…çš„å°ç‰ˆæœ¬ã€‚è¿™......è™½ç„¶å¯¹æˆ‘æ²¡å•¥å½±å“å§ï¼Œä½†å°±æ˜¯æœ‰ç‚¹ä¸çˆ½ã€‚è€Œæ ¹æ®è¿™æ®µè¯æ‰€è¯´çš„ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥åœ¨ <code>package.json</code> ä¸­ <code>engines.node</code> æŒ‡å®šå…·ä½“çš„ç‰ˆæœ¬çš„ï¼Œä¸‹é¢çš„è¡¨æ ¼ä¸­ä¹Ÿåˆ—å‡ºäº†è¿™ä¸€ç‚¹ï¼Œè¯å®äº†æˆ‘çš„çŒœæƒ³ã€‚</p>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifo2eH.png\" alt=\"\"></p>\n<p>äºæ˜¯æˆ‘å…´é«˜é‡‡çƒˆåœ°å» <code>package.json</code> ä¸­æŠŠ <code>engines.node</code> è®¾ç½®æˆ <code>18.17.0</code>ï¼Œä»¥ä¸ºè¿™æ ·é—®é¢˜å°±èƒ½å¾—åˆ°è§£å†³æ—¶ï¼Œ Vercel åœ¨éƒ¨ç½²çš„æ—¶å€™æä¾›äº†è¿™ä¹ˆä¸€å¥è¯ï¼š</p>\n<div class=\"language-plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">Warning: Detected \"engines\": { \"node\": \"18.17.0\" } in your `package.json` with major.minor.patch, but only major Node.js Version can be selected. Learn More: http://vercel.link/node-version\n</code></pre></div>\n<p>å®ƒç«Ÿç„¶ç›´æ¥å¤§èƒ†åœ°è¯´ <strong>only major Node.js Version can be selected</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘åªèƒ½æ§åˆ¶æ˜¯ä¸æ˜¯ 18 è¿™ä¸€ä¸ªå¤§ç‰ˆæœ¬...é‚£æ–‡æ¡£ä¸­è¯´çš„è¿™äº›ï¼Œä¸å°±è·Ÿæ²¡è¯´ä¸€æ ·äº†ã€‚æ›´ä½•å†µè¡¨æ ¼ä¸­å·²ç»åˆ—å‡ºæ¥äº†ï¼Œç»“æœå®é™…ä¸Šåˆä¸æ˜¯è¿™æ ·ã€‚è¿™çœŸæ˜¯è®©äººæ— è¯­åˆ°äº†æç‚¹äº†ã€‚å» GitHub ä¸Šæ‰¾ç±»ä¼¼çš„é—®é¢˜ï¼Œä¹Ÿåªæ‰¾åˆ°äº†è¿™ä¸€ç¯‡ï¼š</p>\n<ul>\n<li>https://github.com/vercel/vercel/discussions/8238</li>\n</ul>\n<p>æœ‰ä½å›ç­”è€…åˆšå¼€å§‹æ˜¯ç…§æ¬æ–‡æ¡£ä¸­æåˆ°å¯ä»¥æ‰‹åŠ¨è®¾ç½®å…·ä½“ç‰ˆæœ¬ï¼Œç»“æœå‘ç°å¹¶ä¸æ˜¯è¿™æ ·ï¼Œäºæ˜¯å°±è¯´åªèƒ½è®¾ç½® major ç‰ˆæœ¬ã€‚åŒæ—¶å¼•ç”¨äº† <a href=\"https://vercel.com/docs/runtimes#official-runtimes/node-js/node-js-version\" class=\"external-link\" target=\"_blank\" rel=\"noopener noreferrer\">Vercel æ–‡æ¡£<span class=\"external-link-icon mdi mdi-launch\"></span></a>ä¸­å‡ºç°çš„è¿™æ ·ä¸€æ®µè¯ï¼š</p>\n<blockquote>\n<p>Only major versions are available. <strong>That's because Vercel will automatically roll out minor and patch updates if needed (for example in the case that a security issue needs to be fixed).</strong></p>\n<p>Defining the node property inside engines of a package.json file will override the selection made in the Project Settings and print a Build Step warning if the version does not match.</p>\n</blockquote>\n<p>å¾ˆå¥½ï¼Œè¿˜ç»™å‡ºäº†åªèƒ½è®¾ç½® major ç‰ˆæœ¬çš„ç†ç”±ï¼Œå› ä¸º Vercel ä¼šè‡ªåŠ¨æ‰“è¡¥ä¸ã€‚å¾ˆæƒ³è¯´ä¸€å¥ï¼Œè°è®©ä½ æ‰“äº†ï¼Ÿåƒç°åœ¨è¿™ç§æƒ…å†µï¼Œ18.18 å¯¼è‡´é—®é¢˜è€Œ 18.17 å°±ä¸ä¼šå¯¼è‡´é—®é¢˜ï¼Œé‚£ä¹ˆè¿™å¥è¯é‡Œæ‰€è¯´çš„ã€Œå› ä¸ºä¼šè‡ªåŠ¨æ‰“è¡¥ä¸æ‰€ä»¥ä¸è®©ä½ æ‰‹åŠ¨è®¾ç½® minor å’Œ patch ç‰ˆæœ¬ã€å°±å¾ˆä¸å¯é äº†ã€‚</p>\n<p>ä¸‹é¢è¿™å¥è¯è¯´äº†åˆæ„Ÿè§‰è·Ÿæ²¡è¯´ä¸€æ ·ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢...</p>\n<h2>æ€»ç»“<a class=\"header-anchor\" id=\"%E6%80%BB%E7%BB%93\" href=\"#%E6%80%BB%E7%BB%93\">#</a></h2>\n<p>è¿™ä¸€æ•´è¶Ÿä¸‹æ¥å‘¢ï¼Œå°±æ˜¯åˆç–‘æƒ‘åˆå¤±æœ›çš„æ„Ÿè§‰å§ï¼Œå°±æ„Ÿè§‰å¾ˆè’è°¬ï¼Œä¸çŸ¥é“è¯´ä»€ä¹ˆçš„è’è°¬ã€‚é‚£ä¹ˆï¼Œæœ€åæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿç”±äº Vercel æœ€ç»ˆæ˜¯å°†ä¸€ä¸ªç›®å½•å†…çš„æ‰€æœ‰æ–‡ä»¶ä½œä¸ºæ— åç«¯åº”ç”¨çš„ä»£ç æ¥è·‘ï¼Œæ‰€ä»¥åªè¦æ‰‹åŠ¨ build åˆ°è¿™ä¸ªç›®å½•é‡Œé¢ï¼Œç„¶åè·³è¿‡åœ¨ Vercel ä¸Šçš„ build è¿‡ç¨‹å°±å¥½äº†ã€‚</p>\n<p>æ‰€ä»¥ç°åœ¨æˆ‘çš„ build æŒ‡ä»¤é•¿è¿™æ ·ï¼š</p>\n<p><img src=\"https://s11.ax1x.com/2023/12/13/pifHPo9.png\" alt=\"\">\n<em>æˆ‘tmç›´æ¥ build successï¼</em></p>\n<p>å…¶å®æ„Ÿè§‰é—®é¢˜ä¸å¤§ï¼Œå°±æ˜¯å¯èƒ½æ¯æ¬¡ commit ä¹‹å‰éƒ½è¦èŠ±ä¸ªä¸€ä¸¤åˆ†é’Ÿæ¥ build ä¸€ä¸‹ã€‚è¿™æ ·çš„æ“ä½œä¼°è®¡å¾—è¦æŒç»­åˆ°ä¸Šé¢æˆ‘æƒ³åˆ°çš„è§£å†³æ–¹æ³•èƒ½å®ç°çš„é‚£ä¸€å¤©äº†ğŸ˜…</p>\n</div></template>","import { render } from \"./Some-Gossip-on-Vercel.vue?vue&type=template&id=c36a42aa\"\nconst script = {}\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createStaticVNode","_hoisted_2","_createElementBlock","_hoisted_1","_hoisted_41","script","__exports__","render"],"sourceRoot":""}